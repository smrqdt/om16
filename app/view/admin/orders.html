{extends file="baseWithNav.html"}

{block name=content}
	<table class="table" id="ordersTable">
		<thead>
			<tr>
				<th>
					{_("order.status")}
				</th>
				<th>
					{_("order.paymentstatus")}
				</th>
				<th>
					{_("order.billingnumber")}
				</th>
				<th>
					{_("order.customer")}
				</th>
				<th>
					{_("item.count")}
				</th>
				<th>
					{_("order.total")}
				</th>
				<th>
					{_("order.lastaction")}
				</th>
				<th>
					{_("show")}
				</th>
				<th>
					{_("delete")}
				</th>
			</tr>
		</thead>
		<tbody>
			{foreach $orders as $order}
			{if $order->status=='payed'}
			<tr class="error">
			{elseif $order->status=='shipped'}
			<tr class="success">
			{elseif $order->payment_status=='loss' || $order->payment_status=='pending' || $order->payment_status=='partially_credited' || $order->payment_status=='untraceable'}
			<tr class="warning">
			{else}
			<tr>
			{/if}
				<td>
					{$order->status}
				</td>
				<td>
					{$order->payment_status}
				</td>
				<td>
					TS-{$order->id}
				</td>
				<td>
					{$order->user->currentAddress()->name} {$order->user->currentAddress()->lastname}
				</td>
				<td>
					{count($order->orderitems)}
				</td>
				<td>
					{($order->getSum()/100)|number_format:2:",":"."} â‚¬
				</td>
				<td>
					{if $order->shippingtime}
						{$order->shippingtime->format('d.m.Y')}
					{elseif $order->paymenttime}
						{$order->paymenttime->format('d.m.Y')}
					{else}
						{$order->ordertime->format('d.m.Y')}
					{/if}
				</td>
				<td>
					<a href="{$path}order/{$order->hashlink}" class="btn"><i class="icon-share"></i></a>
				</td>
				<td>
					<form method="post" action="{$path}order/delete/{$order->id}" style="display:inline">
						<input type="hidden" name="{$csrf_key}" value="{$csrf_token}">
						<button type="submit" class="btn"><i class="icon-trash"></i></button>
					</form>
				</td>
			</tr>
			{/foreach}
		</tbody>
	</table>
{/block}

{block name=moreScripts}
    <script src="{$path}assets/js/jquery.dataTables.min.js"></script>
    <script src="{$path}assets/js/DT_bootstrap.js"></script>
{literal}
	<script type="text/javascript">
    	/* orders table initialisation */
    	$(document).ready(function() {
        	$('#ordersTable').dataTable();
    	} );
	</script>
{/literal}
{/block}